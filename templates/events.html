<!-- Version 2 -->

{% extends "base.html" %}
{% block content %}
<!-- Page header: title on the left, quick link back to home on the right -->
  <!-- VERSION 5 START -->
  <div class="row space-between" style="align-items:flex-end; gap:16px; margin-bottom:24px">
    <div>
      <h2 style="margin:0 0 4px">All charity events</h2>
      <p class="muted" style="margin:0">Browse all published events that are currently available on CharityConnect.</p>
    </div>
    <a class="btn" href="{{ url_for('main.index') }}">Back to home</a>
    <!-- VERSION 5 END -->
  </div>
</section>
<!-- If there are events, show them in a responsive grid -->
{% if events %}
  <div class="events-grid">
    {% for ev in events %}
      <!-- Each event card: cover area, title, price, metadata, and action buttons -->
      <div class="card event-card" style="position:relative">
        <!-- VERSION 5 START -->
        <div class="event-media"
            data-title="{{ ev.title if not ev.cover_image else '' }}"
            {% if ev.cover_image %}
              style="background-image: url(&quot;{{ url_for('main.event_cover', event_id=ev.id) }}&quot;); background-size:cover; background-position:center;"
            {% endif %}
        ></div>
        <!-- VERSION 5 END -->
        <div class="event-body">
          <!-- Event title + price aligned on the same row -->
          <div class="row space-between" style="align-items:flex-start">
            <h3 class="event-title" style="margin:0">{{ ev.title }}</h3>
            <!-- VERSION 5 START -->
            <span style="font-weight:800; font-size:1rem; color:var(--brand-primary); white-space:nowrap; margin-left:8px">
              &euro;{{ '%.2f' % (ev.ticket_price_cents/100) }}
            <!-- VERSION 5 END -->
            </span>
          </div>
          <!-- Date, time, and venue -->
          <div class="event-meta">
            <!-- VERSION 5 START -->
            {{ ev.starts_at.strftime('%d %b %Y') }} at {{ ev.starts_at.strftime('%H:%M') }}
            &bull; {{ ev.venue or 'TBA' }}
            <!-- VERSION 5 END -->
          </div>
          <!-- Optional description if provided by organiser -->
          {% if ev.description %}
            <p class="event-desc">{{ ev.description }}</p>
          {% endif %}
          <!-- Buttons to view event details or go straight to checkout -->
          <div class="event-actions">
            <a class="btn" href="{{ url_for('main.event_detail', event_id=ev.id) }}">View</a>
            <a class="btn primary" href="{{ url_for('main.event_buy', event_id=ev.id) }}">Buy Tickets</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
<!-- If no events exist, show a simple placeholder message -->
{% else %}
  <div class="card">
    <p class="muted" style="margin:0">No events are currently published. Check back soon</p>
  </div>
{% endif %}

{% endblock %}

<!-- Version 2 -->
