<!-- Version 1 -->
{% extends "base.html" %}
{% block content %}

<!-- VERSION 5 START -->
<!-- HERO BAND -->
<section class="hero-band">
  <div style="max-width:620px">
    <h1>Support real charities through transparent events</h1>
    <p>
      CharityConnect lets verified organisers run ticketed fundraising events with full
      transparency â€” donors can see exactly which charities receive their money and in
      what proportions.
    </p>
    <div class="hero-actions">
      <a class="btn-hero-primary" href="{{ url_for('main.events_list') }}">Browse events &rarr;</a>
      <a class="btn-hero-ghost" href="{{ url_for('main.apply_verification') }}">Apply for verification</a>
    </div>
  </div>
</section>

<!-- VERSION 5 START -->
<div class="stat-card">
  <div class="stat-label">Charities supported</div>
  <div class="stat-value">{{ charities_count }}</div>
  <div class="stat-desc">Verified charity partners on the platform</div>
</div>
<div class="stat-card">
  <div class="stat-label">Tickets processed</div>
  <div class="stat-value">{{ tickets_count }}</div>
  <div class="stat-desc">Tickets issued across all events</div>
</div>
<div class="stat-card">
  <div class="stat-label">Funds raised</div>
  <div class="stat-value">&euro;{{ '%.2f' % funds_raised_eur }}</div>
  <div class="stat-desc">Combined ticket revenue &amp; donations</div>
</div>
<!-- VERSION 5 END -->

<!-- HOW IT WORKS + WHY -->
<section style="margin-bottom:28px">
  <div class="row" style="gap:16px; align-items:stretch; flex-wrap:wrap">
    <div class="card" style="flex:1 1 260px; min-width:260px">
      <h3 style="margin:0 0 14px">How it works</h3>
      <ol style="margin:0 0 0 18px; padding:0; font-size:.95rem; line-height:1.8; color:var(--text-0)">
        <li>Organisers and charities apply for verification.</li>
        <li>Admins review applications in the dashboard.</li>
        <li>Verified organisers publish ticketed events.</li>
        <li>Donors buy tickets, optionally add a donation, and receive a QR-coded receipt.</li>
        <li>Funds are split to charities by the published percentages.</li>
      </ol>
    </div>
    <div class="card" style="flex:1 1 260px; min-width:260px">
      <h3 style="margin:0 0 14px">Why organisers choose us</h3>
      <ul style="margin:0 0 0 18px; padding:0; font-size:.95rem; line-height:1.8; color:var(--text-0)">
        <li>Full audit trail for every order and receipt.</li>
        <li>Built-in fund splitting across multiple charities.</li>
        <li>Simple checkout with instant confirmation.</li>
        <li>Verification badge to build trust with donors.</li>
        <li>Refund management handled in one place.</li>
      </ul>
    </div>
  </div>
</section>

<!-- Role-based banner -->
{% if current_role in ['organiser','admin'] %}
  <div class="flash info" style="margin-bottom:20px">
    You can create events via <a href="{{ url_for('main.event_new') }}">New Event</a>.
    Current role: <strong>{{ current_role }}</strong>.
  </div>
{% endif %}

<!-- EVENT GRID -->
<div class="section-title">Upcoming events</div>
{% if events %}
  <div class="events-grid">
    {% for ev in events %}
      <div class="card event-card" style="position:relative">
        <div class="event-media"
            data-title="{{ ev.title if not ev.cover_image else '' }}"
            {% if ev.cover_image %}
              style="background-image: url(&quot;{{ url_for('main.event_cover', event_id=ev.id) }}&quot;); background-size:cover; background-position:center;"
            {% endif %}
        ></div>
        <div class="event-body">
          <div class="row space-between" style="align-items:flex-start">
            <h3 class="event-title" style="margin:0">{{ ev.title }}</h3>
            <span style="font-weight:800; font-size:1rem; color:var(--brand-primary); white-space:nowrap; margin-left:8px">
              &euro;{{ '%.2f' % (ev.ticket_price_cents/100) }}
            </span>
          </div>
          <div class="event-meta">
            {{ ev.starts_at.strftime('%d %b %Y') }} at {{ ev.starts_at.strftime('%H:%M') }}
            &bull; {{ ev.venue or 'TBA' }}
          </div>
          {% if ev.description %}
            <p class="event-desc">{{ ev.description }}</p>
          {% endif %}
          <div class="event-actions">
            <a class="btn" href="{{ url_for('main.event_detail', event_id=ev.id) }}">View</a>
            <a class="btn primary" href="{{ url_for('main.event_buy', event_id=ev.id) }}">Buy Tickets</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="card"><p class="muted" style="margin:0">No events yet.</p></div>
{% endif %}

<!-- VERSION 5 END -->

{% endblock %}
<!-- Version 1 -->